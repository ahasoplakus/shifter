[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Tidy approach to create Shift Tables using {tidyverse} and {gt}",
    "section": "",
    "text": "A shift table is a table that displays the number of subjects who are low, normal or high at baseline and the shift at post-dose. Writing code for a shift table is an easier task, if ADaM datasets are used rather than raw datasets. It represents cross frequencies of baseline values with post-dose values. The produced shift table gives safety information of the subjects during the clinical study.\n\n\n\nThe main purpose of shift tables in any clinical trial is to determine how the categorical result varies from baseline to post-dose.\nIt is important to look at the effect of the drug by comparing values at baseline and post –baseline in any clinical trials. Shift table is one of the analysis approaches suggested in E3 Guidelines to show the number of patients who are low, normal, or high at baseline and then at selected time intervals. It’s easier to figure out any abnormality in data because the layout helps to get the count of subjects at two time points together. Shift tables can be created for any data like labs, vital signs and ECG etc.\n\n\n\nAll safety related data is collected in a clinical trial study for safety analysis. The laboratory data is one of the most important parts of safety analysis in any drug discovery study. The data mapping team and Statistical Programmers in the clinical programming department support the clinical data analysis and reporting process. The data mapping team analyzes and creates SDTM datasets from raw datasets. The Statistical Programming team creates the ADaM datasets and generates reports in a clinical study. ADaM data structure is such that, it has all the necessary variables needed to create reporting code and this makes the job easier for programmers.\nThere are several summary tables commonly used to produce laboratory results. Descriptive statistics, clinically significance, shift tables and toxicity grade summaries are some of the summary tables that are commonly used. The shift table is one of the most frequently requested in a clinical study by statisticians or clinicians. The site that provides the laboratory results usually produces the normal ranges for numeric lab tests. The study team analyzes the lab results based on normal range and then flags or categorizes whether it is low, normal or high.\nWe will focus on how to create such a laboratory shift table in a step-wise explanation."
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this site\n\n1 + 1\n\n[1] 2"
  },
  {
    "objectID": "index.html#shift-tables-in-clinical-trials",
    "href": "index.html#shift-tables-in-clinical-trials",
    "title": "Tidy approach to create Shift Tables using {tidyverse} and {gt}",
    "section": "",
    "text": "A shift table is a table that displays the number of subjects who are low, normal or high at baseline and the shift at post-dose. Writing code for a shift table is an easier task, if ADaM datasets are used rather than raw datasets. It represents cross frequencies of baseline values with post-dose values. The produced shift table gives safety information of the subjects during the clinical study.\n\n\n\nThe main purpose of shift tables in any clinical trial is to determine how the categorical result varies from baseline to post-dose.\nIt is important to look at the effect of the drug by comparing values at baseline and post –baseline in any clinical trials. Shift table is one of the analysis approaches suggested in E3 Guidelines to show the number of patients who are low, normal, or high at baseline and then at selected time intervals. It’s easier to figure out any abnormality in data because the layout helps to get the count of subjects at two time points together. Shift tables can be created for any data like labs, vital signs and ECG etc.\n\n\n\nAll safety related data is collected in a clinical trial study for safety analysis. The laboratory data is one of the most important parts of safety analysis in any drug discovery study. The data mapping team and Statistical Programmers in the clinical programming department support the clinical data analysis and reporting process. The data mapping team analyzes and creates SDTM datasets from raw datasets. The Statistical Programming team creates the ADaM datasets and generates reports in a clinical study. ADaM data structure is such that, it has all the necessary variables needed to create reporting code and this makes the job easier for programmers.\nThere are several summary tables commonly used to produce laboratory results. Descriptive statistics, clinically significance, shift tables and toxicity grade summaries are some of the summary tables that are commonly used. The shift table is one of the most frequently requested in a clinical study by statisticians or clinicians. The site that provides the laboratory results usually produces the normal ranges for numeric lab tests. The study team analyzes the lab results based on normal range and then flags or categorizes whether it is low, normal or high.\nWe will focus on how to create such a laboratory shift table in a step-wise explanation."
  },
  {
    "objectID": "index.html#introduction",
    "href": "index.html#introduction",
    "title": "Tidy approach to create Shift Tables using {tidyverse} and {gt}",
    "section": "Introduction",
    "text": "Introduction\nAll safety related data is collected in a clinical trial study for safety analysis. The laboratory data is one of the most important parts of safety analysis in any drug discovery study. The data mapping team and SAS programmers in the clinical programming department support the clinical data analysis and reporting process. The data mapping team analyzes and creates SDTM datasets from raw datasets. The SAS Programming team creates the ADaM datasets and generates reports in a clinical study. ADaM data structure is such that, it has all the necessary variables needed to create reporting code and this makes the job easier for programmers.\nThere are several summary tables commonly used to produce laboratory results. Descriptive statistics, clinically significance, shift tables and toxicity grade summaries are some of the summary tables that are commonly used. The shift table is one of the most frequently requested in a clinical study by statisticians or clinicians. The site that provides the laboratory results usually produces the normal ranges for numeric lab tests. The study team analyzes the lab results based on normal range and then flags or categorizes whether it is low, normal or high."
  },
  {
    "objectID": "index.html#data-used-to-produce-shift-table",
    "href": "index.html#data-used-to-produce-shift-table",
    "title": "Tidy approach to create Shift Tables using {tidyverse} and {gt}",
    "section": "Data used to produce Shift Table",
    "text": "Data used to produce Shift Table\nThe following ADSL and ADLB ADaM datasets from `{pharmaverseadam} R package are used in creation of shift table and help with understanding the programming process.\nADSL\n\nadsl &lt;- pharmaverseadam::adsl\nslice_head(adsl, n = 10)\n\n# A tibble: 10 × 54\n   STUDYID     USUBJID SUBJID RFSTDTC RFENDTC RFXSTDTC RFXENDTC RFICDTC RFPENDTC\n   &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;   \n 1 CDISCPILOT… 01-701… 1015   2014-0… 2014-0… 2014-01… 2014-07… &lt;NA&gt;    2014-07…\n 2 CDISCPILOT… 01-701… 1023   2012-0… 2012-0… 2012-08… 2012-09… &lt;NA&gt;    2013-02…\n 3 CDISCPILOT… 01-701… 1028   2013-0… 2014-0… 2013-07… 2014-01… &lt;NA&gt;    2014-01…\n 4 CDISCPILOT… 01-701… 1033   2014-0… 2014-0… 2014-03… 2014-03… &lt;NA&gt;    2014-09…\n 5 CDISCPILOT… 01-701… 1034   2014-0… 2014-1… 2014-07… 2014-12… &lt;NA&gt;    2014-12…\n 6 CDISCPILOT… 01-701… 1047   2013-0… 2013-0… 2013-02… 2013-03… &lt;NA&gt;    2013-07…\n 7 CDISCPILOT… 01-701… 1057   &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;     &lt;NA&gt;     &lt;NA&gt;    2013-12…\n 8 CDISCPILOT… 01-701… 1097   2014-0… 2014-0… 2014-01… 2014-07… &lt;NA&gt;    2014-07…\n 9 CDISCPILOT… 01-701… 1111   2012-0… 2012-0… 2012-09… 2012-09… &lt;NA&gt;    2013-02…\n10 CDISCPILOT… 01-701… 1115   2012-1… 2013-0… 2012-11… 2013-01… &lt;NA&gt;    2013-05…\n# ℹ 45 more variables: DTHDTC &lt;chr&gt;, DTHFL &lt;chr&gt;, SITEID &lt;chr&gt;, AGE &lt;dbl&gt;,\n#   AGEU &lt;chr&gt;, SEX &lt;chr&gt;, RACE &lt;chr&gt;, ETHNIC &lt;chr&gt;, ARMCD &lt;chr&gt;, ARM &lt;chr&gt;,\n#   ACTARMCD &lt;chr&gt;, ACTARM &lt;chr&gt;, COUNTRY &lt;chr&gt;, DMDTC &lt;chr&gt;, DMDY &lt;dbl&gt;,\n#   TRT01P &lt;chr&gt;, TRT01A &lt;chr&gt;, TRTSDTM &lt;dttm&gt;, TRTSTMF &lt;chr&gt;, TRTEDTM &lt;dttm&gt;,\n#   TRTETMF &lt;chr&gt;, TRTSDT &lt;date&gt;, TRTEDT &lt;date&gt;, TRTDURD &lt;dbl&gt;, SCRFDT &lt;date&gt;,\n#   EOSDT &lt;date&gt;, EOSSTT &lt;chr&gt;, FRVDT &lt;date&gt;, RANDDT &lt;date&gt;, DTHDT &lt;date&gt;,\n#   DTHDTF &lt;chr&gt;, DTHADY &lt;dbl&gt;, LDDTHELD &lt;dbl&gt;, DTHCAUS &lt;chr&gt;, DTHDOM &lt;chr&gt;, …\n\n\nADLB\n\nadlb &lt;- pharmaverseadam::adlb\nslice_head(adlb, n = 10)\n\n# A tibble: 10 × 111\n   STUDYID  DOMAIN USUBJID LBSEQ LBTESTCD LBTEST LBCAT LBORRES LBORRESU LBORNRLO\n   &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;    &lt;chr&gt;   \n 1 CDISCPI… LB     01-701…     1 ALB      Album… CHEM… 3.8     g/dL     3.3     \n 2 CDISCPI… LB     01-701…    39 ALB      Album… CHEM… 3.9     g/dL     3.3     \n 3 CDISCPI… LB     01-701…    39 ALB      Album… CHEM… 3.9     g/dL     3.3     \n 4 CDISCPI… LB     01-701…    74 ALB      Album… CHEM… 3.8     g/dL     3.3     \n 5 CDISCPI… LB     01-701…   104 ALB      Album… CHEM… 3.7     g/dL     3.3     \n 6 CDISCPI… LB     01-701…   104 ALB      Album… CHEM… 3.7     g/dL     3.3     \n 7 CDISCPI… LB     01-701…   134 ALB      Album… CHEM… 3.8     g/dL     3.3     \n 8 CDISCPI… LB     01-701…   164 ALB      Album… CHEM… 3.8     g/dL     3.3     \n 9 CDISCPI… LB     01-701…   199 ALB      Album… CHEM… 3.7     g/dL     3.3     \n10 CDISCPI… LB     01-701…   229 ALB      Album… CHEM… 3.7     g/dL     3.3     \n# ℹ 101 more variables: LBORNRHI &lt;chr&gt;, LBSTRESC &lt;chr&gt;, LBSTRESN &lt;dbl&gt;,\n#   LBSTRESU &lt;chr&gt;, LBSTNRLO &lt;dbl&gt;, LBSTNRHI &lt;dbl&gt;, LBNRIND &lt;chr&gt;,\n#   LBBLFL &lt;chr&gt;, VISITNUM &lt;dbl&gt;, VISIT &lt;chr&gt;, VISITDY &lt;dbl&gt;, LBDTC &lt;chr&gt;,\n#   LBDY &lt;dbl&gt;, TRTSDT &lt;date&gt;, TRTEDT &lt;date&gt;, TRT01A &lt;chr&gt;, TRT01P &lt;chr&gt;,\n#   ADT &lt;date&gt;, ADY &lt;dbl&gt;, PARAMCD &lt;chr&gt;, PARAM &lt;chr&gt;, PARAMN &lt;dbl&gt;,\n#   PARCAT1 &lt;chr&gt;, AVAL &lt;dbl&gt;, AVALC &lt;chr&gt;, ANRLO &lt;dbl&gt;, ANRHI &lt;dbl&gt;,\n#   DTYPE &lt;chr&gt;, AVISIT &lt;chr&gt;, AVISITN &lt;dbl&gt;, ONTRTFL &lt;chr&gt;, ANRIND &lt;chr&gt;, …"
  },
  {
    "objectID": "index.html#steps",
    "href": "index.html#steps",
    "title": "Tidy approach to create Shift Tables using {tidyverse} suite and {gt}",
    "section": "Steps",
    "text": "Steps\n\nCalculating BIG N\n\nadsl_bign &lt;- select(na_to_missing(adsl), all_of(c(\"USUBJID\", \"TRT01A\"))) |&gt;\n  add_count(.data$TRT01A, name = \"TRT_N\")\nadsl_bign\n\n# A tibble: 306 × 3\n   USUBJID     TRT01A               TRT_N\n   &lt;chr&gt;       &lt;chr&gt;                &lt;int&gt;\n 1 01-701-1015 Placebo                 86\n 2 01-701-1023 Placebo                 86\n 3 01-701-1028 Xanomeline High Dose    72\n 4 01-701-1033 Xanomeline Low Dose     96\n 5 01-701-1034 Xanomeline High Dose    72\n 6 01-701-1047 Placebo                 86\n 7 01-701-1057 Screen Failure          52\n 8 01-701-1097 Xanomeline Low Dose     96\n 9 01-701-1111 Xanomeline Low Dose     96\n10 01-701-1115 Xanomeline Low Dose     96\n# ℹ 296 more rows\n\n\n\n\nPre-process Lab data\n\n# add `N` to the BDS dataset\nadlb &lt;- adlb |&gt;\n  na_to_missing() |&gt;\n  modify_at(\n    c(\"BNRIND\", \"ANRIND\"),\n    \\(x) case_match(\n      x,\n      \"H\" ~ \"High\",\n      \"L\" ~ \"Low\",\n      \"N\" ~ \"Normal\",\n      .default = str_to_title(x)\n    )\n  )\n\nbds_df &lt;- adlb |&gt;\n  filter(!is.na(.data$AVAL), .data$BNRIND != \"&lt;Missing&gt;\",\n         .data$ANRIND != \"&lt;Missing&gt;\", !is.na(VISITDY), between(.data$AVISITN, 7, 24)) |&gt;\n  left_join(adsl_bign) |&gt;\n  mutate(trt_var = paste0(.data$TRT01A, \"&lt;br&gt;(N=\", TRT_N, \")\")) |&gt;\n  select(-TRT_N) |&gt;\n  filter_if(expr(PARAMCD == \"ALKPH\"))\n\nJoining with `by = join_by(USUBJID, TRT01A)`\n\nbds_df\n\n# A tibble: 1,060 × 112\n   STUDYID  DOMAIN USUBJID LBSEQ LBTESTCD LBTEST LBCAT LBORRES LBORRESU LBORNRLO\n   &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;    &lt;chr&gt;   \n 1 CDISCPI… LB     01-701…   105 ALP      Alkal… CHEM… 43      U/L      35      \n 2 CDISCPI… LB     01-701…   135 ALP      Alkal… CHEM… 47      U/L      35      \n 3 CDISCPI… LB     01-701…   165 ALP      Alkal… CHEM… 53      U/L      35      \n 4 CDISCPI… LB     01-701…   200 ALP      Alkal… CHEM… 41      U/L      35      \n 5 CDISCPI… LB     01-701…   230 ALP      Alkal… CHEM… 45      U/L      35      \n 6 CDISCPI… LB     01-701…   260 ALP      Alkal… CHEM… 46      U/L      35      \n 7 CDISCPI… LB     01-701…   295 ALP      Alkal… CHEM… 44      U/L      35      \n 8 CDISCPI… LB     01-701…   104 ALP      Alkal… CHEM… 40      U/L      35      \n 9 CDISCPI… LB     01-701…   134 ALP      Alkal… CHEM… 40      U/L      35      \n10 CDISCPI… LB     01-701…   164 ALP      Alkal… CHEM… 41      U/L      35      \n# ℹ 1,050 more rows\n# ℹ 102 more variables: LBORNRHI &lt;chr&gt;, LBSTRESC &lt;chr&gt;, LBSTRESN &lt;dbl&gt;,\n#   LBSTRESU &lt;chr&gt;, LBSTNRLO &lt;dbl&gt;, LBSTNRHI &lt;dbl&gt;, LBNRIND &lt;chr&gt;,\n#   LBBLFL &lt;chr&gt;, VISITNUM &lt;dbl&gt;, VISIT &lt;chr&gt;, VISITDY &lt;dbl&gt;, LBDTC &lt;chr&gt;,\n#   LBDY &lt;dbl&gt;, TRTSDT &lt;date&gt;, TRTEDT &lt;date&gt;, TRT01A &lt;chr&gt;, TRT01P &lt;chr&gt;,\n#   ADT &lt;date&gt;, ADY &lt;dbl&gt;, PARAMCD &lt;chr&gt;, PARAM &lt;chr&gt;, PARAMN &lt;dbl&gt;,\n#   PARCAT1 &lt;chr&gt;, AVAL &lt;dbl&gt;, AVALC &lt;chr&gt;, ANRLO &lt;dbl&gt;, ANRHI &lt;dbl&gt;, …\n\n\n\ntab_spanners &lt;- unique(bds_df$trt_var)\nm_tab_spanners &lt;- paste0(tab_spanners, \"&lt;br&gt;Baseline&lt;br&gt;n (%)\")\nN_Placebo &lt;- get_trt_N(adsl_bign, \"TRT01A\", \"Placebo\")\nN_Xano_High &lt;- get_trt_N(adsl_bign, \"TRT01A\", \"Xanomeline High Dose\")\nN_Xano_Low &lt;- get_trt_N(adsl_bign, \"TRT01A\", \"Xanomeline Low Dose\")\n\n\nrep &lt;-\n  build_shift_table(\n    bds_dataset = bds_df,\n    trt_var = exprs(trt_var),\n    analysis_grade_var = exprs(ANRIND),\n    base_grade_var = exprs(BNRIND),\n    grade_var_order = exprs(Low, Normal, High)\n  )\n\nrep |&gt;\n  gt::gt(groupname_col = \"AVISIT\", row_group_as_column = TRUE) |&gt;\n  gt::cols_label(ANRIND = gt::md(\"Reference Range&lt;br&gt;Indicator\")) |&gt;\n  gt::cols_label_with(columns = contains(\"&lt;-&gt;\"), \\(x) custom_split(x, \"&lt;-&gt;\")) |&gt;\n  gt::tab_spanner(columns = contains(tab_spanners[1]), label = gt::md(m_tab_spanners[1])) |&gt;\n  gt::tab_spanner(columns = contains(tab_spanners[2]), label = gt::md(m_tab_spanners[2])) |&gt;\n  gt::tab_spanner(columns = contains(tab_spanners[3]), label = gt::md(m_tab_spanners[3])) |&gt;\n  gt::data_color(method = \"numeric\", palette = gt_pal(), columns = c(3, 5, 7, 9, 11, 13)) |&gt;\n  gt::text_transform(\n    fn = \\(x) add_pct(x, N_Placebo, 2),\n    locations = gt::cells_body(columns = contains(tab_spanners[1]))\n  ) |&gt;\n  gt::text_transform(\n    fn = \\(x) add_pct(x, N_Xano_High, 2),\n    locations = gt::cells_body(columns = contains(tab_spanners[2]))\n  ) |&gt;\n  gt::text_transform(\n    fn = \\(x) add_pct(x, N_Xano_Low, 2),\n    locations = gt::cells_body(columns = contains(tab_spanners[3]))\n  ) |&gt;\n  gt::tab_stubhead(label = gt::md(\"Analysis&lt;br&gt;Visit\")) |&gt;\n  gt::tab_source_note(source_note = \"This is a source note.\") |&gt;\n  gt::tab_footnote(\n    footnote = \"This is a footnote.\",\n    locations = gt::cells_body(columns = 1, rows = 1)\n  ) |&gt;\n  gt::tab_header(\n    title = \"The title of the table\",\n    subtitle = \"The table's subtitle\"\n  ) |&gt;\n  gt::opt_table_lines()\n\n\n\n\n\n  \n    \n      The title of the table\n    \n    \n      The table's subtitle\n    \n    \n      AnalysisVisit\n      Reference RangeIndicator\n      \n        Placebo(N=86)Baselinen (%)\n      \n      \n        Xanomeline High Dose(N=72)Baselinen (%)\n      \n      \n        Xanomeline Low Dose(N=96)Baselinen (%)\n      \n    \n    \n      Low\n      Normal\n      High\n      Total\n      Low\n      Normal\n      High\n      Total\n      Low\n      Normal\n      High\n      Total\n    \n  \n  \n    Week 6\nLow\n3 (3.49%)\n0 (0%)\n0 (0%)\n3 (3.49%)\n1 (1.39%)\n2 (2.78%)\n0 (0%)\n3 (4.17%)\n1 (1.04%)\n0 (0%)\n0 (0%)\n1 (1.04%)\n    Normal\n1 (1.16%)\n68 (79.07%)\n1 (1.16%)\n70 (81.4%)\n0 (0%)\n61 (84.72%)\n0 (0%)\n61 (84.72%)\n0 (0%)\n59 (61.46%)\n0 (0%)\n59 (61.46%)\n    High\n0 (0%)\n0 (0%)\n2 (2.33%)\n2 (2.33%)\n0 (0%)\n2 (2.78%)\n1 (1.39%)\n3 (4.17%)\n0 (0%)\n2 (2.08%)\n2 (2.08%)\n4 (4.17%)\n    Total\n4 (4.65%)\n68 (79.07%)\n3 (3.49%)\n75 (87.21%)\n1 (1.39%)\n65 (90.28%)\n1 (1.39%)\n67 (93.06%)\n1 (1.04%)\n61 (63.54%)\n2 (2.08%)\n64 (66.67%)\n    Week 8\nLow\n1 (1.16%)\n1 (1.16%)\n0 (0%)\n2 (2.33%)\n0 (0%)\n1 (1.39%)\n0 (0%)\n1 (1.39%)\n0 (0%)\n0 (0%)\n0 (0%)\n0 (0%)\n    Normal\n3 (3.49%)\n65 (75.58%)\n0 (0%)\n68 (79.07%)\n0 (0%)\n50 (69.44%)\n0 (0%)\n50 (69.44%)\n0 (0%)\n56 (58.33%)\n0 (0%)\n56 (58.33%)\n    High\n0 (0%)\n0 (0%)\n3 (3.49%)\n3 (3.49%)\n0 (0%)\n4 (5.56%)\n1 (1.39%)\n5 (6.94%)\n0 (0%)\n3 (3.12%)\n1 (1.04%)\n4 (4.17%)\n    Total\n4 (4.65%)\n66 (76.74%)\n3 (3.49%)\n73 (84.88%)\n0 (0%)\n55 (76.39%)\n1 (1.39%)\n56 (77.78%)\n0 (0%)\n59 (61.46%)\n1 (1.04%)\n60 (62.5%)\n    Week 12\nLow\n2 (2.33%)\n0 (0%)\n0 (0%)\n2 (2.33%)\n0 (0%)\n1 (1.39%)\n0 (0%)\n1 (1.39%)\n0 (0%)\n0 (0%)\n0 (0%)\n0 (0%)\n    Normal\n2 (2.33%)\n59 (68.6%)\n0 (0%)\n61 (70.93%)\n0 (0%)\n48 (66.67%)\n0 (0%)\n48 (66.67%)\n0 (0%)\n49 (51.04%)\n0 (0%)\n49 (51.04%)\n    High\n0 (0%)\n1 (1.16%)\n3 (3.49%)\n4 (4.65%)\n0 (0%)\n0 (0%)\n1 (1.39%)\n1 (1.39%)\n0 (0%)\n2 (2.08%)\n1 (1.04%)\n3 (3.12%)\n    Total\n4 (4.65%)\n60 (69.77%)\n3 (3.49%)\n67 (77.91%)\n0 (0%)\n49 (68.06%)\n1 (1.39%)\n50 (69.44%)\n0 (0%)\n51 (53.12%)\n1 (1.04%)\n52 (54.17%)\n    Week 16\nLow\n2 (2.33%)\n0 (0%)\n0 (0%)\n2 (2.33%)\n0 (0%)\n1 (1.39%)\n0 (0%)\n1 (1.39%)\n0 (0%)\n0 (0%)\n0 (0%)\n0 (0%)\n    Normal\n2 (2.33%)\n59 (68.6%)\n1 (1.16%)\n62 (72.09%)\n0 (0%)\n34 (47.22%)\n0 (0%)\n34 (47.22%)\n0 (0%)\n40 (41.67%)\n0 (0%)\n40 (41.67%)\n    High\n0 (0%)\n2 (2.33%)\n2 (2.33%)\n4 (4.65%)\n0 (0%)\n1 (1.39%)\n1 (1.39%)\n2 (2.78%)\n0 (0%)\n1 (1.04%)\n1 (1.04%)\n2 (2.08%)\n    Total\n4 (4.65%)\n61 (70.93%)\n3 (3.49%)\n68 (79.07%)\n0 (0%)\n36 (50%)\n1 (1.39%)\n37 (51.39%)\n0 (0%)\n41 (42.71%)\n1 (1.04%)\n42 (43.75%)\n    Week 20\nLow\n2 (2.33%)\n1 (1.16%)\n0 (0%)\n3 (3.49%)\n0 (0%)\n1 (1.39%)\n0 (0%)\n1 (1.39%)\n0 (0%)\n1 (1.04%)\n0 (0%)\n1 (1.04%)\n    Normal\n2 (2.33%)\n55 (63.95%)\n1 (1.16%)\n58 (67.44%)\n0 (0%)\n29 (40.28%)\n0 (0%)\n29 (40.28%)\n0 (0%)\n29 (30.21%)\n0 (0%)\n29 (30.21%)\n    High\n0 (0%)\n2 (2.33%)\n2 (2.33%)\n4 (4.65%)\n0 (0%)\n0 (0%)\n1 (1.39%)\n1 (1.39%)\n0 (0%)\n0 (0%)\n1 (1.04%)\n1 (1.04%)\n    Total\n4 (4.65%)\n58 (67.44%)\n3 (3.49%)\n65 (75.58%)\n0 (0%)\n30 (41.67%)\n1 (1.39%)\n31 (43.06%)\n0 (0%)\n30 (31.25%)\n1 (1.04%)\n31 (32.29%)\n    Week 24\nLow\n1 (1.16%)\n0 (0%)\n0 (0%)\n1 (1.16%)\n0 (0%)\n0 (0%)\n0 (0%)\n0 (0%)\n0 (0%)\n0 (0%)\n0 (0%)\n0 (0%)\n    Normal\n3 (3.49%)\n47 (54.65%)\n1 (1.16%)\n51 (59.3%)\n0 (0%)\n29 (40.28%)\n0 (0%)\n29 (40.28%)\n0 (0%)\n26 (27.08%)\n0 (0%)\n26 (27.08%)\n    High\n0 (0%)\n2 (2.33%)\n2 (2.33%)\n4 (4.65%)\n0 (0%)\n1 (1.39%)\n0 (0%)\n1 (1.39%)\n0 (0%)\n0 (0%)\n1 (1.04%)\n1 (1.04%)\n    Total\n4 (4.65%)\n49 (56.98%)\n3 (3.49%)\n56 (65.12%)\n0 (0%)\n30 (41.67%)\n0 (0%)\n30 (41.67%)\n0 (0%)\n26 (27.08%)\n1 (1.04%)\n27 (28.12%)\n    Week 26\nLow\n2 (2.33%)\n1 (1.16%)\n0 (0%)\n3 (3.49%)\n0 (0%)\n1 (1.39%)\n0 (0%)\n1 (1.39%)\n0 (0%)\n0 (0%)\n0 (0%)\n0 (0%)\n    Normal\n2 (2.33%)\n48 (55.81%)\n1 (1.16%)\n51 (59.3%)\n0 (0%)\n26 (36.11%)\n0 (0%)\n26 (36.11%)\n0 (0%)\n24 (25%)\n0 (0%)\n24 (25%)\n    High\n0 (0%)\n1 (1.16%)\n2 (2.33%)\n3 (3.49%)\n0 (0%)\n0 (0%)\n0 (0%)\n0 (0%)\n0 (0%)\n0 (0%)\n1 (1.04%)\n1 (1.04%)\n    Total\n4 (4.65%)\n50 (58.14%)\n3 (3.49%)\n57 (66.28%)\n0 (0%)\n27 (37.5%)\n0 (0%)\n27 (37.5%)\n0 (0%)\n24 (25%)\n1 (1.04%)\n25 (26.04%)\n  \n  \n    \n      This is a source note."
  },
  {
    "objectID": "index.html#required-packages-and-programs",
    "href": "index.html#required-packages-and-programs",
    "title": "Tidy approach to create Shift Tables using {tidyverse} and {gt}",
    "section": "Required Packages and Programs",
    "text": "Required Packages and Programs\n\nsuppressPackageStartupMessages(library(dplyr))\nsuppressPackageStartupMessages(library(tidyr))\nsuppressPackageStartupMessages(library(rlang))\nsuppressPackageStartupMessages(library(purrr))\nsuppressPackageStartupMessages(library(stringr))\n\nwalk(list.files(here::here(\"R\"), pattern = \".R\", full.names = TRUE), source)"
  },
  {
    "objectID": "index.html#steps-to-create-a-shift-table",
    "href": "index.html#steps-to-create-a-shift-table",
    "title": "Tidy approach to create Shift Tables using {tidyverse} and {gt}",
    "section": "Steps to create a Shift Table",
    "text": "Steps to create a Shift Table\n\n1. Calculating BIG N\n\nadsl_bign &lt;- select(na_to_missing(adsl), all_of(c(\"USUBJID\", \"TRT01A\"))) |&gt;\n  add_count(.data$TRT01A, name = \"TRT_N\")\nadsl_bign\n\n# A tibble: 306 × 3\n   USUBJID     TRT01A               TRT_N\n   &lt;chr&gt;       &lt;chr&gt;                &lt;int&gt;\n 1 01-701-1015 Placebo                 86\n 2 01-701-1023 Placebo                 86\n 3 01-701-1028 Xanomeline High Dose    72\n 4 01-701-1033 Xanomeline Low Dose     96\n 5 01-701-1034 Xanomeline High Dose    72\n 6 01-701-1047 Placebo                 86\n 7 01-701-1057 Screen Failure          52\n 8 01-701-1097 Xanomeline Low Dose     96\n 9 01-701-1111 Xanomeline Low Dose     96\n10 01-701-1115 Xanomeline Low Dose     96\n# ℹ 296 more rows\n\n\n\n\n2. Pre-process Lab data\n\nGet rid of missing BNRIND, ANRIND, AVAL, VISITDY\nAdd BIG N to adlb\nKeeping only Alkaline Phosphatase records across Week 6-Week 24 Visits (AVISIT)\nConcatenating BIG N with Treatment Labels in trt_var\n\n\nadlb_prep &lt;- adlb |&gt;\n  na_to_missing() |&gt;\n  mutate(across(all_of(c(\"BNRIND\", \"ANRIND\")), str_to_title)) |&gt;\n  left_join(adsl_bign) |&gt;\n  filter(\n    !is.na(.data$AVAL), .data$BNRIND != \"&lt;Missing&gt;\", .data$ANRIND != \"&lt;Missing&gt;\",\n    !is.na(.data$VISITDY), .data$PARAMCD == \"ALKPH\", between(.data$AVISITN, 7, 24)\n  ) |&gt;\n  mutate(trt_var = paste0(.data$TRT01A, \"&lt;br&gt;(N=\", TRT_N, \")\")) |&gt;\n  select(-TRT_N)\n\nJoining with `by = join_by(USUBJID, TRT01A)`\n\nadlb_prep\n\n# A tibble: 1,060 × 112\n   STUDYID  DOMAIN USUBJID LBSEQ LBTESTCD LBTEST LBCAT LBORRES LBORRESU LBORNRLO\n   &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;    &lt;chr&gt;   \n 1 CDISCPI… LB     01-701…   105 ALP      Alkal… CHEM… 43      U/L      35      \n 2 CDISCPI… LB     01-701…   135 ALP      Alkal… CHEM… 47      U/L      35      \n 3 CDISCPI… LB     01-701…   165 ALP      Alkal… CHEM… 53      U/L      35      \n 4 CDISCPI… LB     01-701…   200 ALP      Alkal… CHEM… 41      U/L      35      \n 5 CDISCPI… LB     01-701…   230 ALP      Alkal… CHEM… 45      U/L      35      \n 6 CDISCPI… LB     01-701…   260 ALP      Alkal… CHEM… 46      U/L      35      \n 7 CDISCPI… LB     01-701…   295 ALP      Alkal… CHEM… 44      U/L      35      \n 8 CDISCPI… LB     01-701…   104 ALP      Alkal… CHEM… 40      U/L      35      \n 9 CDISCPI… LB     01-701…   134 ALP      Alkal… CHEM… 40      U/L      35      \n10 CDISCPI… LB     01-701…   164 ALP      Alkal… CHEM… 41      U/L      35      \n# ℹ 1,050 more rows\n# ℹ 102 more variables: LBORNRHI &lt;chr&gt;, LBSTRESC &lt;chr&gt;, LBSTRESN &lt;dbl&gt;,\n#   LBSTRESU &lt;chr&gt;, LBSTNRLO &lt;dbl&gt;, LBSTNRHI &lt;dbl&gt;, LBNRIND &lt;chr&gt;,\n#   LBBLFL &lt;chr&gt;, VISITNUM &lt;dbl&gt;, VISIT &lt;chr&gt;, VISITDY &lt;dbl&gt;, LBDTC &lt;chr&gt;,\n#   LBDY &lt;dbl&gt;, TRTSDT &lt;date&gt;, TRTEDT &lt;date&gt;, TRT01A &lt;chr&gt;, TRT01P &lt;chr&gt;,\n#   ADT &lt;date&gt;, ADY &lt;dbl&gt;, PARAMCD &lt;chr&gt;, PARAM &lt;chr&gt;, PARAMN &lt;dbl&gt;,\n#   PARCAT1 &lt;chr&gt;, AVAL &lt;dbl&gt;, AVALC &lt;chr&gt;, ANRLO &lt;dbl&gt;, ANRHI &lt;dbl&gt;, …\n\n\n\ntab_spanners &lt;- unique(adlb_prep$trt_var)\nm_tab_spanners &lt;- paste0(tab_spanners, \"&lt;br&gt;Baseline&lt;br&gt;n (%)\")\nN_Placebo &lt;- get_trt_N(adsl_bign, \"TRT01A\", \"Placebo\")\nN_Xano_High &lt;- get_trt_N(adsl_bign, \"TRT01A\", \"Xanomeline High Dose\")\nN_Xano_Low &lt;- get_trt_N(adsl_bign, \"TRT01A\", \"Xanomeline Low Dose\")\n\n\nrep &lt;-\n  build_shift_table(\n    bds_dataset = adlb_prep,\n    trt_var = exprs(trt_var),\n    analysis_grade_var = exprs(ANRIND),\n    base_grade_var = exprs(BNRIND),\n    grade_var_order = exprs(Low, Normal, High)\n  )\n\nrep |&gt;\n  gt::gt(groupname_col = \"AVISIT\", row_group_as_column = TRUE) |&gt;\n  gt::cols_label(ANRIND = gt::md(\"Post&lt;br&gt;Baseline\")) |&gt;\n  gt::cols_label_with(columns = contains(\"&lt;-&gt;\"), \\(x) custom_split(x, \"&lt;-&gt;\")) |&gt;\n  gt::tab_spanner(columns = contains(tab_spanners[1]), label = gt::md(m_tab_spanners[1])) |&gt;\n  gt::tab_spanner(columns = contains(tab_spanners[2]), label = gt::md(m_tab_spanners[2])) |&gt;\n  gt::tab_spanner(columns = contains(tab_spanners[3]), label = gt::md(m_tab_spanners[3])) |&gt;\n  gt::data_color(method = \"numeric\", palette = gt_pal(), columns = c(3, 5, 7, 9, 11, 13)) |&gt;\n  gt::text_transform(\n    fn = \\(x) add_pct(x, N_Placebo, 2),\n    locations = gt::cells_body(columns = contains(tab_spanners[1]))\n  ) |&gt;\n  gt::text_transform(\n    fn = \\(x) add_pct(x, N_Xano_High, 2),\n    locations = gt::cells_body(columns = contains(tab_spanners[2]))\n  ) |&gt;\n  gt::text_transform(\n    fn = \\(x) add_pct(x, N_Xano_Low, 2),\n    locations = gt::cells_body(columns = contains(tab_spanners[3]))\n  ) |&gt;\n  #gt::tab_stubhead(label = gt::md(\"Analysis&lt;br&gt;Visit\")) |&gt;\n  gt::tab_source_note(source_note = \"This is a source note.\") |&gt;\n  gt::tab_footnote(\n    footnote = \"This is a footnote.\",\n    locations = gt::cells_body(columns = 1, rows = 1)\n  ) |&gt;\n  gt::tab_header(\n    title = \"The title of the table\",\n    subtitle = \"The table's subtitle\"\n  ) |&gt;\n  gt::opt_table_lines()\n\n\n\n\n\n  \n    \n      The title of the table\n    \n    \n      The table's subtitle\n    \n    \n      \n      PostBaseline\n      \n        Placebo(N=86)Baselinen (%)\n      \n      \n        Xanomeline High Dose(N=72)Baselinen (%)\n      \n      \n        Xanomeline Low Dose(N=96)Baselinen (%)\n      \n    \n    \n      Low\n      Normal\n      High\n      Total\n      Low\n      Normal\n      High\n      Total\n      Low\n      Normal\n      High\n      Total\n    \n  \n  \n    Week 6\nLow\n3 (3.49%)\n0 (0%)\n0 (0%)\n3 (3.49%)\n1 (1.39%)\n2 (2.78%)\n0 (0%)\n3 (4.17%)\n1 (1.04%)\n0 (0%)\n0 (0%)\n1 (1.04%)\n    Normal\n1 (1.16%)\n68 (79.07%)\n1 (1.16%)\n70 (81.4%)\n0 (0%)\n61 (84.72%)\n0 (0%)\n61 (84.72%)\n0 (0%)\n59 (61.46%)\n0 (0%)\n59 (61.46%)\n    High\n0 (0%)\n0 (0%)\n2 (2.33%)\n2 (2.33%)\n0 (0%)\n2 (2.78%)\n1 (1.39%)\n3 (4.17%)\n0 (0%)\n2 (2.08%)\n2 (2.08%)\n4 (4.17%)\n    Total\n4 (4.65%)\n68 (79.07%)\n3 (3.49%)\n75 (87.21%)\n1 (1.39%)\n65 (90.28%)\n1 (1.39%)\n67 (93.06%)\n1 (1.04%)\n61 (63.54%)\n2 (2.08%)\n64 (66.67%)\n    Week 8\nLow\n1 (1.16%)\n1 (1.16%)\n0 (0%)\n2 (2.33%)\n0 (0%)\n1 (1.39%)\n0 (0%)\n1 (1.39%)\n0 (0%)\n0 (0%)\n0 (0%)\n0 (0%)\n    Normal\n3 (3.49%)\n65 (75.58%)\n0 (0%)\n68 (79.07%)\n0 (0%)\n50 (69.44%)\n0 (0%)\n50 (69.44%)\n0 (0%)\n56 (58.33%)\n0 (0%)\n56 (58.33%)\n    High\n0 (0%)\n0 (0%)\n3 (3.49%)\n3 (3.49%)\n0 (0%)\n4 (5.56%)\n1 (1.39%)\n5 (6.94%)\n0 (0%)\n3 (3.12%)\n1 (1.04%)\n4 (4.17%)\n    Total\n4 (4.65%)\n66 (76.74%)\n3 (3.49%)\n73 (84.88%)\n0 (0%)\n55 (76.39%)\n1 (1.39%)\n56 (77.78%)\n0 (0%)\n59 (61.46%)\n1 (1.04%)\n60 (62.5%)\n    Week 12\nLow\n2 (2.33%)\n0 (0%)\n0 (0%)\n2 (2.33%)\n0 (0%)\n1 (1.39%)\n0 (0%)\n1 (1.39%)\n0 (0%)\n0 (0%)\n0 (0%)\n0 (0%)\n    Normal\n2 (2.33%)\n59 (68.6%)\n0 (0%)\n61 (70.93%)\n0 (0%)\n48 (66.67%)\n0 (0%)\n48 (66.67%)\n0 (0%)\n49 (51.04%)\n0 (0%)\n49 (51.04%)\n    High\n0 (0%)\n1 (1.16%)\n3 (3.49%)\n4 (4.65%)\n0 (0%)\n0 (0%)\n1 (1.39%)\n1 (1.39%)\n0 (0%)\n2 (2.08%)\n1 (1.04%)\n3 (3.12%)\n    Total\n4 (4.65%)\n60 (69.77%)\n3 (3.49%)\n67 (77.91%)\n0 (0%)\n49 (68.06%)\n1 (1.39%)\n50 (69.44%)\n0 (0%)\n51 (53.12%)\n1 (1.04%)\n52 (54.17%)\n    Week 16\nLow\n2 (2.33%)\n0 (0%)\n0 (0%)\n2 (2.33%)\n0 (0%)\n1 (1.39%)\n0 (0%)\n1 (1.39%)\n0 (0%)\n0 (0%)\n0 (0%)\n0 (0%)\n    Normal\n2 (2.33%)\n59 (68.6%)\n1 (1.16%)\n62 (72.09%)\n0 (0%)\n34 (47.22%)\n0 (0%)\n34 (47.22%)\n0 (0%)\n40 (41.67%)\n0 (0%)\n40 (41.67%)\n    High\n0 (0%)\n2 (2.33%)\n2 (2.33%)\n4 (4.65%)\n0 (0%)\n1 (1.39%)\n1 (1.39%)\n2 (2.78%)\n0 (0%)\n1 (1.04%)\n1 (1.04%)\n2 (2.08%)\n    Total\n4 (4.65%)\n61 (70.93%)\n3 (3.49%)\n68 (79.07%)\n0 (0%)\n36 (50%)\n1 (1.39%)\n37 (51.39%)\n0 (0%)\n41 (42.71%)\n1 (1.04%)\n42 (43.75%)\n    Week 20\nLow\n2 (2.33%)\n1 (1.16%)\n0 (0%)\n3 (3.49%)\n0 (0%)\n1 (1.39%)\n0 (0%)\n1 (1.39%)\n0 (0%)\n1 (1.04%)\n0 (0%)\n1 (1.04%)\n    Normal\n2 (2.33%)\n55 (63.95%)\n1 (1.16%)\n58 (67.44%)\n0 (0%)\n29 (40.28%)\n0 (0%)\n29 (40.28%)\n0 (0%)\n29 (30.21%)\n0 (0%)\n29 (30.21%)\n    High\n0 (0%)\n2 (2.33%)\n2 (2.33%)\n4 (4.65%)\n0 (0%)\n0 (0%)\n1 (1.39%)\n1 (1.39%)\n0 (0%)\n0 (0%)\n1 (1.04%)\n1 (1.04%)\n    Total\n4 (4.65%)\n58 (67.44%)\n3 (3.49%)\n65 (75.58%)\n0 (0%)\n30 (41.67%)\n1 (1.39%)\n31 (43.06%)\n0 (0%)\n30 (31.25%)\n1 (1.04%)\n31 (32.29%)\n    Week 24\nLow\n1 (1.16%)\n0 (0%)\n0 (0%)\n1 (1.16%)\n0 (0%)\n0 (0%)\n0 (0%)\n0 (0%)\n0 (0%)\n0 (0%)\n0 (0%)\n0 (0%)\n    Normal\n3 (3.49%)\n47 (54.65%)\n1 (1.16%)\n51 (59.3%)\n0 (0%)\n29 (40.28%)\n0 (0%)\n29 (40.28%)\n0 (0%)\n26 (27.08%)\n0 (0%)\n26 (27.08%)\n    High\n0 (0%)\n2 (2.33%)\n2 (2.33%)\n4 (4.65%)\n0 (0%)\n1 (1.39%)\n0 (0%)\n1 (1.39%)\n0 (0%)\n0 (0%)\n1 (1.04%)\n1 (1.04%)\n    Total\n4 (4.65%)\n49 (56.98%)\n3 (3.49%)\n56 (65.12%)\n0 (0%)\n30 (41.67%)\n0 (0%)\n30 (41.67%)\n0 (0%)\n26 (27.08%)\n1 (1.04%)\n27 (28.12%)\n    Week 26\nLow\n2 (2.33%)\n1 (1.16%)\n0 (0%)\n3 (3.49%)\n0 (0%)\n1 (1.39%)\n0 (0%)\n1 (1.39%)\n0 (0%)\n0 (0%)\n0 (0%)\n0 (0%)\n    Normal\n2 (2.33%)\n48 (55.81%)\n1 (1.16%)\n51 (59.3%)\n0 (0%)\n26 (36.11%)\n0 (0%)\n26 (36.11%)\n0 (0%)\n24 (25%)\n0 (0%)\n24 (25%)\n    High\n0 (0%)\n1 (1.16%)\n2 (2.33%)\n3 (3.49%)\n0 (0%)\n0 (0%)\n0 (0%)\n0 (0%)\n0 (0%)\n0 (0%)\n1 (1.04%)\n1 (1.04%)\n    Total\n4 (4.65%)\n50 (58.14%)\n3 (3.49%)\n57 (66.28%)\n0 (0%)\n27 (37.5%)\n0 (0%)\n27 (37.5%)\n0 (0%)\n24 (25%)\n1 (1.04%)\n25 (26.04%)\n  \n  \n    \n      This is a source note."
  },
  {
    "objectID": "index.html#purpose",
    "href": "index.html#purpose",
    "title": "Tidy approach to create Shift Tables using {tidyverse} and {gt}",
    "section": "Purpose",
    "text": "Purpose\nThe main purpose of shift tables in any clinical trial is to determine how the categorical result varies from baseline to post-dose.\nIt is important to look at the effect of the drug by comparing values at baseline and post –baseline in any clinical trials. Shift table is one of the analysis approaches suggested in E3 Guidelines to show the number of patients who are low, normal, or high at baseline and then at selected time intervals. It’s easier to figure out any abnormality in data because the layout helps to get the count of subjects at two time points together. Shift tables can be created for any data like labs, vital signs and ECG etc.\nWe will focus on how to create such a laboratory shift table in a step-wise explanation."
  }
]